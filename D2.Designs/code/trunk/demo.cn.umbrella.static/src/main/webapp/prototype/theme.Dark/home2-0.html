<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>首页</title>
	<link rel="stylesheet" type="text/css" href="css/icon.font.css"/>
	<link rel="stylesheet" type="text/css" href="css/home.layout2.css"/>
</head>
<body>
	<div class="wrapper home">
		<!-- 头部 -->
		<div class="nav-outer">
			<div class="nav-inner">
				<div class="nav-box">
					<h1 class="logo"></h1>
					<ul class="nav" id="nav">
						<li>
							<a href="index.html">
								首页
							</a>
							
						</li>
						<li class="cur">
							<a href="report.html">
								数据管理系统
							</a>
						</li>
						<li>
							<a href="###">
								数据查询系统
							</a>
						</li>
						<li>
							<a href="###">
								报告管理系统
							</a>
						</li>
						<li>
							<a href="###">
								数据挖掘系统
							</a>
						</li>
						<li>
							<a href="###">
								应用支撑系统
							</a>
						</li>
					</ul>
					<div class="overflow-hidden">
						<ul class="top-info right">
							<li class="relative">
								<a href="###">您好，李玉东（cxy）<span class="fi-arrow-down"></span></a>
								
								<div class="user-control">
									<a href="###">
										<span class="fi-key"></span>
										修改密码
									</a>
									<a href="###">
										<span class="fi-envelop"></span>
										消息
									</a>
									<a href="###">
										<span class="fi-cog"></span>
										设置
									</a>
								</div>
							</li>
							<li>
								<a href="###">
									<span class="fi-exit"></span>退出
								</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		
			<div class="vertical-shadow"></div>
		</div>
		<!-- 主体 -->
		<div class="main" style="bottom: 0;">
			<div class="chart-outer">
				<div class="chart-fl">
					<div class="chart-top h-per50">
						<div class="block-box w-per100 h-per100 charts-box">
							<div id="pie1" style="width:100%;"></div>
						</div>
					</div>
					<div class="chart-bottom h-per50">
						<div class="block-box w-per100 h-per100 charts-box">
							<div id="pie2" style="width:100%;"></div>
						</div>
					</div>
				</div>
				<div class="chart-fc relative">
					<div class="map-left piecewise-outer">
						<div class="piecewise-list selected">
							<h5>自然人数量</h5>
							<p><i class="bg-color1"></i><span><min>&lt;</min><max>100</max>万人</span></p>
							<p><i class="bg-color2"></i><span><min>101</min>~<max>150</max>万人</span></p>
							<p><i class="bg-color3"></i><span><min>151</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color4"></i><span><min>201</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color5"></i><span><min>251</min>~<max>300</max>万人</span></p>
							<p><i class="bg-color6"></i><span><min>301</min><max>&lt;=</max>万人</span></p>
						</div>
						<div class="piecewise-list">
							<h5>企业数量</h5>
							<p><i class="bg-color1"></i><span><min>&lt;</min><max>100</max>万人</span></p>
							<p><i class="bg-color2"></i><span><min>101</min>~<max>150</max>万人</span></p>
							<p><i class="bg-color3"></i><span><min>151</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color4"></i><span><min>201</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color5"></i><span><min>251</min>~<max>300</max>万人</span></p>
							<p><i class="bg-color6"></i><span><min>301</min><max>&lt;=</max>万人</span></p>
						</div>
						<div class="piecewise-list">
							<h5>温州本地自然人信用评级</h5>
							<p><i class="bg-color1"></i><span><min>&lt;</min><max>100</max>万人</span></p>
							<p><i class="bg-color2"></i><span><min>101</min>~<max>150</max>万人</span></p>
							<p><i class="bg-color3"></i><span><min>151</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color4"></i><span><min>201</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color5"></i><span><min>251</min>~<max>300</max>万人</span></p>
							<p><i class="bg-color6"></i><span><min>301</min><max>&lt;=</max>万人</span></p>
						</div>
						<div class="piecewise-list">
							<h5>温州本地企业信用评级</h5>
							<p><i class="bg-color1"></i><span><min>&lt;</min><max>100</max>万人</span></p>
							<p><i class="bg-color2"></i><span><min>101</min>~<max>150</max>万人</span></p>
							<p><i class="bg-color3"></i><span><min>151</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color4"></i><span><min>201</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color5"></i><span><min>251</min>~<max>300</max>万人</span></p>
							<p><i class="bg-color6"></i><span><min>301</min><max>&lt;=</max>万人</span></p>
						</div>
						<div class="piecewise-list">
							<h5>浙江省温州属地企业信用评级</h5>
							<p><i class="bg-color1"></i><span><min>&lt;</min><max>100</max>万人</span></p>
							<p><i class="bg-color2"></i><span><min>101</min>~<max>150</max>万人</span></p>
							<p><i class="bg-color3"></i><span><min>151</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color4"></i><span><min>201</min>~<max>250</max>万人</span></p>
							<p><i class="bg-color5"></i><span><min>251</min>~<max>300</max>万人</span></p>
							<p><i class="bg-color6"></i><span><min>301</min><max>&lt;=</max>万人</span></p>
						</div>
					</div>
					<div class="map-right">
						<div class="w-per100 h-per100 charts-box">
							<div id="wzMap" style="width:100%;"></div>
						</div>
					</div>
				</div>
				<div class="chart-fr">
					<div class="chart-top">
						<a href="###" class="level-box level3">
							<h5>三级预警</h5>
							<p>
								<label><i class="fi-company"></i><span>100</span></label>
								<label><i class="fi-dm-natural-man"></i><span>2000</span></label>
							</p>
						</a>
						<a href="###" class="level-box level2">
							<h5>二级预警</h5>
							<p>
								<label><i class="fi-company"></i><span>100</span></label>
								<label><i class="fi-dm-natural-man"></i><span>2000</span></label>
							</p>
						</a>
						<a href="###" class="level-box level1">
							<h5>一级预警</h5>
							<p>
								<label><i class="fi-company"></i><span>100</span></label>
								<label><i class="fi-dm-natural-man"></i><span>2000</span></label>
							</p>
						</a>
					</div>
					<div class="chart-bottom home-ranking-list blacklist absolute">
						<div class="home-list">
							<h6>企业黑名单</h6>
							<div class="list-inner">
								<div class="scrollbar">
									<div class="box">
										<ul class="content">
											<li><a href="###"><i class="circle-icon"></i>杭州六翼科技有限公司</a></li>
											<li><a href="###"><i class="circle-icon"></i>杭州六翼科技有限公司</a></li>
											<li><a href="###"><i class="circle-icon"></i>杭州六翼科技有限公司杭州六翼科技有限公司</a></li>
											<li><a href="###"><i class="circle-icon"></i>杭州六翼科技有限公司</a></li>
											<li><a href="###"><i class="circle-icon"></i>杭州六翼科技有限公司</a></li>
										</ul>
									</div>
									<div class="track"><div></div></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>



	<script type="text/javascript" src="../../thirdparty/jquery-1.11.3/jquery.min.js"></script>
	<!--echarts-->
	<script type="text/javascript" src="../../thirdparty/echarts-3.2.3/echarts.js"></script>
	<!--widget-gh-pages-->
	<script type="text/javascript" src="js/widget-gh-pages/jquery.scrollbar.js"></script>
	<script type="text/javascript">
		//导航大小
		function navSize(){
			var winWidth = $(document.body).width(),
				winHei = $(document.body).height();
			if( winWidth < 1100){
				$(".logo").width(45);
				$(".nav").css('margin-left',64);
				if(winWidth < 900){
					$(".nav li a").css({'margin-left': '7px','margin-right': '7px'});
				};
			}else{
				$(".logo").width(172);
				$(".nav").css('margin-left',230);
				$(".nav li a").css({'margin-left': '12px','margin-right': '12px'});
				
			};
		};
		$(function(){
			//导航大小
			navSize();
			//地图控制
			$(".piecewise-list.selected").animate({
				'height': 204
			}).css({
				'background':'#fff',
				'borderColor': '#2dc7f3',
				'borderWidth':'2px'
			});
			$(".piecewise-list h5").click(function(){
				var $this = $(this).closest('.piecewise-list');
				$(".piecewise-outer .piecewise-list").removeClass('selected');
				$this.addClass('selected').siblings('.piecewise-list').removeClass('selected');
				$this.animate({
					'height': 204
				}).css({
					'background':'#fff',
					'borderColor': '#2dc7f3',
					'borderWidth':'2px'
				});
				$this.siblings('.piecewise-list').animate({
					'height': 40
				}).css({
					'background':'#e5e5e5',
					'borderColor': '#dbdbdb',
					'borderWidth':'1px'
				});
			});
			
			//滚动条
			$(".scrollbar").scrollbar();
		})
	</script>
	<script type="text/javascript">
		var pie1 = echarts.init(document.getElementById('pie1'));
		var option1 = {
		    title : {
		        text: '信用评估',
		        textStyle:{
		        	fontSize: 14,
		        	fontWeight:'normal'
		        },
//		        textBaseline :'top',
		        textAlign: 'center',
		        x: '55%',
		        y : '34%',
		        subtext:'自然人',
		        subtextStyle:{
		        	fontSize: 16,
		        	fontWeight:'bold',
		        	color:'#20bbef'
		        }
		    },
		    tooltip : {
		        trigger: 'item',
		        formatter: "{a} <br/>{b} : {c} ({d}%)"
		    },
		    legend: {
		        x : -5,
//		        bottom: '10%',
				orient: 'vertical',
		        data:['AAA','AA','A','B','C','D'],
		        itemWidth: 16,//矩形宽度,默认25
		        itemHeight: 16, //矩形高度,默认14
		        textStyle: {
                    fontSize: 14 //标签字号
                }
		    },
		    calculable : true,
		    series : [
		        {
		            type:'pie',
		          	radius: ['40%', '70%'],
		            center : ['57%', '40%'],
		            stillShowZeroSum: false,
		            data:[
		            	{value:30, name:'AAA'},
		            	{value:12, name:'AA'},
		                {value:10, name:'A'},
		                {value:5, name:'B'},
		                {value:15, name:'C'},
		                {value:25, name:'D'},
		            ],
		            itemStyle: {
		                normal: {
		                    color: function(params) {
		                        // build a color map as your need.
		                        var colorList = [
		                          '#25bcee','#2fc3ee','#5fd3f4','#92dff4','#c6eaf3','#e2f6fb'
		                        ];
		                        return colorList[params.dataIndex]
		                    },
		                    label: {
		                     	show : false,
                            },
                            labelLine: {
                                show: false
                            }
		                }
		            }
		        }
		    ]
		};
		pie1.setOption(option1);

		var pie2 = echarts.init(document.getElementById('pie2'));
		var option2 = {
		    title : {
		        text: '信用评估',
		        textStyle:{
		        	fontSize: 14,
		        	fontWeight:'normal'
		        },
//		        textBaseline :'top',
		        textAlign: 'center',
		        x: '55%',
		        y : '34%',
		        subtext:'企业',
		        subtextStyle:{
		        	fontSize: 16,
		        	fontWeight:'bold',
		        	color:'#20bbef'
		        }
		    },
		    tooltip : {
		        trigger: 'item',
		        formatter: "{a} <br/>{b} : {c} ({d}%)"
		    },
		    legend: {
		        x : -5,
//		        bottom: '10%',
				orient: 'vertical',
		        data:['AAA','AA','A','B','C','D'],
		        itemWidth: 16,//矩形宽度,默认25
		        itemHeight: 16, //矩形高度,默认14
		        textStyle: {
                    fontSize: 14 //标签字号
                }
		    },
		    calculable : true,
		    series : [
		        {
		            type:'pie',
		            radius: ['40%', '70%'],
		            center : ['57%', '40%'],
		            stillShowZeroSum: false,
		            data:[
		                {value:30, name:'AAA'},
		            	{value:12, name:'AA'},
		                {value:10, name:'A'},
		                {value:5, name:'B'},
		                {value:15, name:'C'},
		                {value:25, name:'D'},
		            ],
		            itemStyle: {
		                normal: {
		                    color: function(params) {
		                        // build a color map as your need.
		                        var colorList = [
		                          '#25bcee','#2fc3ee','#5fd3f4','#92dff4','#c6eaf3','#e2f6fb'
		                        ];
		                        return colorList[params.dataIndex]
		                    },
		                    label: {
		                     	show : false,
                            },
                            labelLine: {
                                show: false
                            }
		                },
		            }
		        }
		    ]
		};
		pie2.setOption(option2);

		var data = [
			{name: '永嘉县',value: Math.round(Math.random()*1000)},
			{name: '乐清市',value: Math.round(Math.random()*1000)},
			{name: '鹿城区',value: Math.round(Math.random()*1000)},
			{name: '瓯海区',value: Math.round(Math.random()*1000)},
			{name: '龙湾区',value: Math.round(Math.random()*1000)},
			{name: '洞头区',value: Math.round(Math.random()*1000)},
			{name: '瑞安市',value: Math.round(Math.random()*100)},
			{name: '文成县',value: Math.round(Math.random()*100)},
			{name: '平阳县',value: Math.round(Math.random()*100)},
			{name: '苍南县',value: Math.round(Math.random()*100)},
			{name: '泰顺县',value: Math.round(Math.random()*100)},
		];

		var map1 = echarts.init(document.getElementById('wzMap'));
		$.get('js/wenzhou.json', function (mapData) {
			echarts.registerMap('wenzhou', mapData);
			var $this = $(".piecewise-list.selected");
			showMap($this);
		});
		
		var coptions = {};
		$(".piecewise-list").click(function(){
            var $this = $(this);
			showMap($this);
		});

		$(".piecewise-list p").hover(function(){
			var color = $(this).find('i').css('backgroundColor');
			$.each(data,function(i,idata){
				var iColor = idata.itemStyle.normal.color;
				if(iColor == color){
					idata.itemStyle = {
						normal: {
							color: 'rgb(253,186,55)'
						}
					};
				}
			});
			coptions.series[0].data = data;
			map1.setOption(coptions);
			map1.dispatchAction({ type: 'restore' });
		},function(){
			var color = 'rgb(253,186,55)';
			var rColor = $(this).find('i').css('backgroundColor');
			$.each(data,function(i,idata){
				var iColor = idata.itemStyle.normal.color;
				if(iColor == color){
					idata.itemStyle = {
						normal: {
							color: rColor
						}
					};
				}
			});
			coptions.series[0].data = data;
			map1.setOption(coptions);
			map1.dispatchAction({ type: 'restore' });
		});

		function showMap(obj){
			var legend = $(obj).find("h5").text();
			var legendData = getLegendArr($(obj));

			var option3 = {
				title: {
					text: null
				},
				tooltip: {
					trigger: 'item',
					formatter : function (params) {
						var value = (params.value + '').split('.');
						value = value[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, '$1,')
								+ '.' + value[1];
						return params.name + ' : ' + params.value;
					}
				},
				legend: {
					show:false,//是否显示,默认true
					selectedMode:'single',
					left: 'right',
					data:[legend]
				},
				visualMap: [],
				series: [{
					name: legend,
					type: 'map',
					map: 'wenzhou',
					layoutCenter: ['50%', '53%'],
					// 如果宽高比大于 1 则宽度为 100，如果小于 1 则高度为 100，保证了不超过 100x100 的区域
					layoutSize: '100%',
					label: {
						normal: {
							show: true,
							textStyle:{
								fontSize: 16
							}
						},
						emphasis: {
							label: {
								show: true
							},
							textStyle:{
								fontSize: 16
							},
							areaColor: '#fdba37',
						}
					}
				}],
			};

			var seriesData = seriesDatas(legendData,data);
			option3.series[0].data = seriesData;

			coptions = option3;
			map1.setOption(option3);
			map1.dispatchAction({ type: 'restore' });

		}

		function getLegendArr(obj){
			var legendArr =[];
			var $this = $(obj);

			var pObj = $this.find("P");
			$.each(pObj,function(index,pLegend){
				var color = $(pLegend).find('i').css('backgroundColor');
				var max = $(pLegend).find('max').html();
				if(isNaN(max)){
					max = 'max';
				}
				var min = $(pLegend).find('min').html();
				if(isNaN(min)){
					min = 'min';
				}
				var legend ={};
				legend.color = color;
				legend.max = max;
				legend.min = min;
				legendArr.push(legend);
			});
			return legendArr;
		}

		function seriesDatas(legendData,data){
			$.each(data,function(i,idata){
				$.each(legendData,function(l,ldata){
                      if(ldata.max!= 'max' && ldata.min!= 'min'){
						  if(idata.value < ldata.max && idata.value > ldata.min){
							  idata.itemStyle = {
								  normal: {
									  color: ldata.color
								  }
							  };
							  return;
						  }
					  }else{
						  if(ldata.max == 'max'){
							  if(idata.value > ldata.min){
								  idata.itemStyle = {
									  normal: {
										  color: ldata.color
									  }
								  };
								  return;
							  }
						  }
						  if(ldata.min == 'min'){
							  if(idata.value < ldata.max){
								  idata.itemStyle = {
									  normal: {
										  color: ldata.color
									  }
								  };
								  return;
							  }
						  }
					  }
				});
			});
			return data;
		}

        
        //下拉显示
		function slideShow(){
			$('.user-control').css({
				'top':$(".fi-arrow-down").parent('a').offset().top + 10 + $(".fi-arrow-down").parent('a').outerHeight(),
				'left':$(".fi-arrow-down").parent('a').offset().left + 30 + 'px'
			}).slideDown().show();
		};
		//下拉隐藏
		function slideHide(){
			$('.user-control').fadeOut("fast");
		};
		//图表大小
		function chartWH(){
			$(".charts-box div[id]").each(function(){
				$(this).css({
					"width":$(this).closest('.charts-box').width(),"height":$(this).closest('.charts-box').height()
				})
			})
		};
		$(function() {
			//头部用户信息下拉
			$('.top-info .fi-arrow-down').parent('a').click(function(){
				slideShow();
			});
			$('.user-control').mouseleave(function() {
				slideHide();
			});
			$("body").bind("click",function(evt){ 
				if($(evt.target).parents(".top-info").length==0) slideHide();
			});
			//图表大小
			chartWH();
			//图表自适应
			pie1.resize();
			pie2.resize();
			map1.resize();
		});
		//监听窗体大小变更事件
		$(window).resize(function(){
			//导航大小
			navSize();
			//图表大小
			chartWH();
			pie1.resize(); 
			pie2.resize();
			map1.resize();
			//滚动条
			$(".scrollbar").scrollbar();
		});
	</script>
</body>
</html>